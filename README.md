# My Bank App

[Click here](https://mermaid.live/view/#eyJjb2RlIjoic2VxdWVuY2VEaWFncmFtXG4gICAgYWN0b3IgQ3VzdG9tZXJcbiAgICBwYXJ0aWNpcGFudCBNb2JpbGVBcHBcbiAgICBwYXJ0aWNpcGFudCBDdXN0b21lclNlcnZpY2VcbiAgICBwYXJ0aWNpcGFudCBLYWZrYVxuICAgIHBhcnRpY2lwYW50IEFjY291bnRTZXJ2aWNlXG4gICAgcGFydGljaXBhbnQgQ2FyZFNlcnZpY2VcbiAgICBwYXJ0aWNpcGFudCBMaW1pdFNlcnZpY2VcblxuICAgIGFjdGl2YXRlIEN1c3RvbWVyXG4gICAgQ3VzdG9tZXIgLT4-KyBNb2JpbGVBcHA6IHNpZ25zIHVwXG5cbiAgICBNb2JpbGVBcHAgLT4-KyBDdXN0b21lclNlcnZpY2U6IGNyZWF0ZXMgbmV3IGN1c3RvbWVyIChQT1NUIC9hcGkvY3VzdG9tZXIpXG4gICAgQ3VzdG9tZXJTZXJ2aWNlIC0-PiBDdXN0b21lclNlcnZpY2U6IHNhdmVzIGN1c3RvbWVyIGludG8gZGF0YWJhc2VcbiAgICBDdXN0b21lclNlcnZpY2UgLT4-IEthZmthOiBwdWJsaXNoZXMgQ3VzdG9tZXJDcmVhdGVkRXZlbnRcbiAgICBDdXN0b21lclNlcnZpY2UgLT4-LSBNb2JpbGVBcHA6IDIwMSAoQ1JFQVRFRClcbiAgICBNb2JpbGVBcHAgLT4-LSBDdXN0b21lcjogZGlzcGxheXMgdGhhdCBhY2NvdW50IGlzIGJlaW5nIGNyZWF0ZWQgYW5kIG1pZ2h0IHRha2Ugc29tZSB0aW1lXG4gICAgZGVhY3RpdmF0ZSBDdXN0b21lclxuXG5cbiAgICBLYWZrYSAtPj4gQWNjb3VudFNlcnZpY2U6IGNvbnN1bWVzIEN1c3RvbWVyQ3JlYXRlZEV2ZW50XG4gICAgYWN0aXZhdGUgQWNjb3VudFNlcnZpY2VcbiAgICBBY2NvdW50U2VydmljZSAtPj4gQWNjb3VudFNlcnZpY2U6IGdlbmVyYXRlIGFjY291bnQgKElCQU4pXG4gICAgQWNjb3VudFNlcnZpY2UgLT4-IEFjY291bnRTZXJ2aWNlOiBzYXZlIGFjY291bnQgaW50byBkYXRhYmFzZVxuICAgIEFjY291bnRTZXJ2aWNlIC0-PiBLYWZrYTogcHVibGlzaGVzIEFjY291bnRDcmVhdGVkRXZlbnRcbiAgICBkZWFjdGl2YXRlIEFjY291bnRTZXJ2aWNlXG5cbiAgICBLYWZrYSAtPj4gQ2FyZFNlcnZpY2U6IGNvbnN1bWVzIEFjY291bnRDcmVhdGVkRXZlbnRcbiAgICBhY3RpdmF0ZSBDYXJkU2VydmljZVxuICAgIENhcmRTZXJ2aWNlIC0-PiBDYXJkU2VydmljZTogZ2VuZXJhdGUgY2FyZCBkZXRhaWxzIChudW1iZXIgKyBjdnYgKyBuYW1lKVxuICAgIENhcmRTZXJ2aWNlIC0-PiBDYXJkU2VydmljZTogc2F2ZSBjYXJkIGludG8gZGF0YWJhc2VcbiAgICBDYXJkU2VydmljZSAtPj4gS2Fma2E6IHB1Ymxpc2hlcyBDYXJkQ3JlYXRlZEV2ZW50XG4gICAgZGVhY3RpdmF0ZSBDYXJkU2VydmljZVxuXG4gICAgS2Fma2EgLT4-IExpbWl0U2VydmljZTogY29uc3VtZXMgQWNjb3VudENyZWF0ZWRFdmVudFxuICAgIGFjdGl2YXRlIExpbWl0U2VydmljZVxuICAgIExpbWl0U2VydmljZSAtPj4gTGltaXRTZXJ2aWNlOiBkZWZpbmVzIGFjY291bnQgZGVmYXVsdCBsaW1pdHNcbiAgICBMaW1pdFNlcnZpY2UgLT4-IExpbWl0U2VydmljZTogc2F2ZSBhY2NvdW50IGxpbWl0IGludG8gZGF0YWJhc2VcbiAgICBMaW1pdFNlcnZpY2UgLT4-IEthZmthOiBwdWJsaXNoZXMgQWNjb3VudExpbWl0RGVmaW5lZEV2ZW50XG4gICAgZGVhY3RpdmF0ZSBMaW1pdFNlcnZpY2VcblxuICAgIEthZmthIC0-PiBMaW1pdFNlcnZpY2U6IGNvbnN1bWVzIENhcmRDcmVhdGVkRXZlbnRcbiAgICBhY3RpdmF0ZSBMaW1pdFNlcnZpY2VcbiAgICBMaW1pdFNlcnZpY2UgLT4-IExpbWl0U2VydmljZTogZGVmaW5lcyBjYXJkIGRlZmF1bHQgbGltaXRzXG4gICAgTGltaXRTZXJ2aWNlIC0-PiBMaW1pdFNlcnZpY2U6IHNhdmUgY2FyZCBsaW1pdHMgaW50byBkYXRhYmFzZVxuICAgIExpbWl0U2VydmljZSAtPj4gS2Fma2E6IHB1Ymxpc2hlcyBDYXJkTGltaXREZWZpbmVkRXZlbnRcbiAgICBkZWFjdGl2YXRlIExpbWl0U2VydmljZVxuICAgICBcbiAgICBcblxuXG5cblxuXG5cblxuIiwibWVybWFpZCI6IntcbiAgXCJ0aGVtZVwiOiBcImRlZmF1bHRcIlxufSIsInVwZGF0ZUVkaXRvciI6dHJ1ZSwiYXV0b1N5bmMiOnRydWUsInVwZGF0ZURpYWdyYW0iOnRydWV9) to see the Diagram 

## Step 1: CustomerService

Create a microservice (CustomerService) which will be responsible for handling the customer data and will expose the following endpoints:

### Create Customer Endpoint

**Endpoint**: POST /api/customer

**Body**: 
```json
{
    "firstName": "John",
    "lastName": "Doe",
    "birthdate": "1992-07-20",
    "email": "john.doe@gmail.com",
    "nationality": "Brazil",
    "document": {
        "type": "PASSPORT | ID",
        "number": "FG123345BR"
    },	
    "addresses": [
        {
            "type": "DELIVERY | BILLING",
            "postCode": "38401293",
            "address": "Rua das Oliveiras",
            "number": "123",
            "complement": "Optional"
        }
    ]
}
```

This endpoint should validate customer data, save the customer into the database and finally publishes an event into kafka (CustomerCreatedEvent) with the following data:

CustomerCreatedEvent
```json
{
    "customerId": "cfb45ec7-f6f8-408b-8115-68d8c7fadbea"
}
```

If everything works correctly, the endpoint should return the HTTP status  `201 (Created)`

*Each customer must have a document, a billing adress and a billing address.*

### Get Customer By ID Endpoint

**Endpoint**: GET /api/customer/{customerId}

This endpoint should look for the customer with given id into the database and return the data following the format below. The endpoint should return the HTTP status `200 OK` if the customer is found or `404 NOT FOUND` otherwise.

```json
{
    "id": "cfb45ec7-f6f8-408b-8115-68d8c7fadbea"
    "firstName": "John",
    "lastName": "Doe",
    "email": "john.doe@gmail.com",
    "birthdate": "1992-07-20",
    "nationality": "Brazil",
    "document": {
        "type": "PASSPORT",
        "number": "FG123345BR"
    },	
    "addresses": [
        {
            "id": "9a1673df-c929-416b-b6fc-ed44b2942c41"
            "type": "DELIVERY | BILLING",
            "postCode": "38401293",
            "address": "Rua das Oliveiras",
	    "number": "123",
	    "complement": "Optional"
	}
    ]
}

### Delete Customer Endpoint

**Endpoint**: DELETE /api/customer/{customerId}

This endpoint should delete the customer with given id (SOFT DELETE). The endpoint should return the HTTP status `204 NO CONTENT` if the customer was removed successfully, `404 NOT FOUND` if customer is not found.

No payload should be returned from this endpoint.


### Update Customer By ID Endpoint

**Endpoint**: PUT /api/customer/{customerId}

This endpoint should update the customer with given id into the database and return the data following the format below. The endpoint should return the HTTP status `200 OK` if the customer is found and updated sucessfully, `404 NOT FOUND` if customer is not found or if customer is inactive and `400 BAD REQUEST` if the data provided is invalid.

** All the fields, but the ID should be updatable. **

This operation replaces the whole object with the provided structure. 

```json
{
    "id": "cfb45ec7-f6f8-408b-8115-68d8c7fadbea"
    "firstName": "John",
    "lastName": "Doe",
    "email": "john.doe.updated@gmail.com",
    "birthdate": "1992-07-20",
    "nationality": "Brazil",
    "document": {
        "type": "PASSPORT",
        "number": "FG123345BR"
    },	
    "addresses": [
        {
            "id": "9a1673df-c929-416b-b6fc-ed44b2942c41"
            "type": "DELIVERY | BILLING",
            "postCode": "38401293",
            "address": "Rua das Oliveiras",
	    "number": "123",
	    "complement": "Optional"
	}
    ]
}
```


